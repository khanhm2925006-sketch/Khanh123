import numpy as np

def solve_cubic(a, b, c, d):
    """
    Giải phương trình bậc 3: ax^3 + bx^2 + cx + d = 0
    Sử dụng NumPy để tìm nghiệm.
    """
    if a == 0:
        print("Lỗi: Đây không phải phương trình bậc 3 (a phải khác 0).")
        return None
    
    # Đa thức hệ số: [a, b, c, d]
    coefficients = [a, b, c, d]
    
    # Tìm nghiệm bằng NumPy
    roots = np.roots(coefficients)
    
    return roots

def main():
    print("Chương trình giải phương trình bậc 3: ax³ + bx² + cx + d = 0")
    print("Nhập các hệ số (a, b, c, d). Lưu ý: a phải khác 0.")
    
    try:
        a = float(input("Nhập a: "))
        b = float(input("Nhập b: "))
        c = float(input("Nhập c: "))
        d = float(input("Nhập d: "))
        
        roots = solve_cubic(a, b, c, d)
        
        if roots is not None:
            print("\nCác nghiệm của phương trình là:")
            for i, root in enumerate(roots, 1):
                # Hiển thị nghiệm thực hoặc phức
                if np.isreal(root):
                    print(f"Nghiệm {i}: {root.real:.4f} (thực)")
                else:
                    print(f"Nghiệm {i}: {root:.4f} (phức)")
            
            # Kiểm tra và hiển thị số nghiệm thực
            real_roots = [r for r in roots if np.isreal(r)]
            print(f"\nSố nghiệm thực: {len(real_roots)}")
    
    except ValueError:
        print("Lỗi: Vui lòng nhập số hợp lệ.")

if __name__ == "__main__":
    main()
